!function (t) {
    if ("object" == typeof exports && "undefined" != typeof module)module.exports = t();
    else if ("function" == typeof define && define.amd)define([], t);
    else {
        var n;
        n = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this, n.buoy = t()
    }
}(function () {
    return function t (n, e, i) {
        function r (s, p) {
            if (!e[s]) {
                if (!n[s]) {
                    var a = "function" == typeof require && require;
                    if (!p && a)return a(s, !0);
                    if (o)return o(s, !0);
                    var u = new Error("Cannot find module '" + s + "'");
                    throw u.code = "MODULE_NOT_FOUND", u
                }
                var l = e[s] = {exports: {}};
                n[s][0].call(l.exports, function (t) {
                    var e = n[s][1][t];
                    return r(e ? e : t)
                }, l, l.exports, t, n, e, i)
            }
            return e[s].exports
        }

        for (var o = "function" == typeof require && require, s = 0; s < i.length; s++)r(i[s]);
        return r
    }({
        1: [function (t, n, e) {
            var i = t("./lib/Intent"), r = t("./lib/Component"), o = t("./lib/Channel"), s = t("./lib/Radio");
            n.exports.Component = r, n.exports.component = function (t) {
                return new r(t)
            }, n.exports.Intent = i, n.exports.intent = function (t) {
                return new i(t)
            }, n.exports.Channel = o, n.exports.channel = function (t) {
                return new o(t)
            }, n.exports.Radio = s, n.exports.radio = function () {
                return new s
            }
        }, {"./lib/Channel": 2, "./lib/Component": 3, "./lib/Intent": 4, "./lib/Radio": 6}],
        2: [function (t, n, e) {
            function i (t) {
                this.name = t || ""
            }

            n.exports = i, i.prototype = [], i.prototype.constructor = i, i.prototype.broadcast = i.prototype.publish = function () {
                var t = this.slice(), n = t.length;
                if (!n)return !1;
                for (var e, i = null, r = -1; ++r < n;)if (e = t[r], e.proxy && (e = e.proxy), i = e.apply(null, arguments), null != i)return i;
                return !1
            }, i.prototype.subscribe = function (t) {
                return "function" != typeof t ? (console.warn("Listener is not a function", t), this) : (this.isSubscribed(t) || this.push(t), this)
            }, i.prototype.unsubscribe = function (t) {
                var n = this.indexOf(t);
                return ~n && this.splice(n, 1), this
            }, i.prototype.peek = function (t) {
                var n = this;
                return t.proxy = function () {
                    var e = t.apply(null, arguments);
                    return n.unsubscribe(t), e
                }, this.subscribe(t), this
            }, i.prototype.isSubscribed = function (t) {
                return !(!t || !~this.indexOf(t))
            }, i.prototype.hasSubscribers = function () {
                return this.length > 0
            }, i.prototype.empty = function () {
                return this.splice(0), this
            }
        }, {}],
        3: [function (t, n, e) {
            function i (t, n) {
                this.name = t || "", this.parent = n || null, this.active = !0, this._componentList = [], this._components = {}, this._services = {}, this._lazyClients = {}, this._intentFilters = {}, c.call(this)
            }

            function r (t) {
                if (!t.parent)return t;
                for (; t.parent;)t = t.parent;
                return t
            }

            function o (t, n, e) {
                var i = r(t);
                i.serviceExists(n) || (i._services[n] = e, s(t, n, e), i.relay("service", {
                    name: n,
                    handler: e
                }), i.relay("service:" + n, {name: n, handler: e}))
            }

            function s (t, n, e) {
                var i = r(t), o = i._lazyClients[n];
                o && o.length && (o.forEach(function (t) {
                    e.apply(null, t)
                }), i._lazyClients[n] = [])
            }

            function p (t, n) {
                function e () {
                    for (; s + 1 == r && o.length;)s = o.pop(), i = s[1], s = s[0], r = i.length
                }

                if (n(t) === !1)return !1;
                var i = t._componentList, r = i.length;
                if (!r)return !0;
                for (var o = [], s = -1; ++s < r;) {
                    if (t = i[s], n(t) === !1)return !1;
                    t._componentList.length ? (o.push([s, i]), i = t._componentList, s = -1, r = i.length) : e()
                }
                return !0
            }

            var a = (t("./Channel"), t("./Intent")), u = t("./Operation"), l = t("./Transmission"), c = t("./Radio");
            n.exports = i, i.prototype = Object.create(c.prototype), Object.defineProperty(i.prototype, "root", {
                get: function () {
                    return r(this)
                }
            }), i.prototype.component = function (t) {
                if (!t)return console.error("Can't define component from empty arguments"), null;
                if (this == t)return console.warn("Setting self as sub-component is not supported"), this;
                if (t instanceof i && null != t.parent)return console.warn("Transferring components is not supported"), t;
                if (this.isComponentDefined(t))return "string" == typeof t ? this._components[t] : this._components[t.name];
                "string" == typeof t && (t = new i(t, this)), t.parent = this, this._components[t.name] = t, this._componentList.push(t);
                var n, e = r(this), p = t._services, a = t._lazyClients;
                for (n in a)a.hasOwnProperty(n) && (Array.isArray(e._lazyClients[n]) ? e._lazyClients[n] = e._lazyClients[n].concat(a[n].slice()) : e._lazyClients[n] = a[n].slice(), this.serviceExists(n) && s(t, n, this._services[n]));
                for (n in p)p.hasOwnProperty(n) && o(e, n, p[n]);
                return t._services = {}, t._lazyClients = {}, t
            }, i.prototype.isSubComponent = function (t) {
                return null != t && this._components[t.name] == t
            }, i.prototype.isComponentDefined = function (t) {
                return null != t && ("string" == typeof t ? this._components.hasOwnProperty(t) : this._components.hasOwnProperty(t.name))
            }, i.prototype.deleteComponent = function (t) {
                this.isComponentDefined(t) && ("string" == typeof t ? (delete this._components[t], this._componentList = this._componentList.filter(function (n) {
                    return n.name != t
                })) : (delete this._components[t.name], this._componentList = this._componentList.filter(function (n) {
                    return n.name != t.name
                })))
            }, i.prototype.activate = function () {
                this.active = !0
            }, i.prototype.deactivate = function () {
                this.active = !1
            }, i.prototype.service = function (t, n) {
                return o(this, t, n), this
            }, i.prototype.serviceExists = i.prototype.serviceAvailable = function (t) {
                return r(this)._services.hasOwnProperty(t)
            }, i.prototype.deleteService = function (t) {
                return delete r(this)._services[t]
            }, i.prototype.invoke = function (t) {
                var n = r(this)._services[t];
                if (!n)return null;
                var e = [].slice.call(arguments, 1);
                return n.apply(null, e)
            }, i.prototype.invokeLazy = i.prototype.lazy = function (t) {
                var n = [].slice.call(arguments, 1), e = r(this), i = e._services[t];
                if (!i) {
                    var o = e._lazyClients[t] || (e._lazyClients[t] = []);
                    return o.push(n), null
                }
                return i.apply(null, n)
            }, i.prototype.whenAvailable = function (t, n) {
                this.serviceAvailable(t) ? n() : this.attempt("service:" + t, function () {
                    n()
                })
            }, i.prototype.intent = function (t, n, e) {
                var i = this._intentFilters[t];
                return i || (this._intentFilters[t] = []), this._intentFilters[t].push(new u(n, e, !1)), this
            }, i.prototype.attempt = function (t, n, e) {
                var i = this._intentFilters[t];
                return i || (this._intentFilters[t] = []), this._intentFilters[t].push(new u(n, e, !0)), this
            }, i.prototype.relay = function (t, n, e) {
                var i = n instanceof a ? n : new a(n), r = new l(i, e);
                return p(this, function (n) {
                    var e = n._intentFilters[t];
                    return Array.isArray(e) && e.length && e.some(function (t) {
                        return r.handle(t), i.interrupted
                    }), !i.interrupted
                }), i.interrupted || r.attemptFinish(), i
            }, i.prototype.relayGlobal = function (t, n, e) {
                return i.prototype.relay.apply(r(this), arguments)
            }, i.prototype.bubbleIntent = function (t, n, e) {
                for (var i, r = new a(n), o = new l(r, e), s = this.parent; s;) {
                    if (i = s._intentFilters[t], Array.isArray(i) && i.length && i.some(function (t) {
                            return o.handle(t), r.interrupted
                        }), r.interrupted)return r;
                    s = s.parent
                }
                return o.attemptFinish(), r
            }, i.prototype.triggerIntent = function (t, n) {
                var e = this._intentFilters[t];
                if (Array.isArray(e) && e.length) {
                    var i = n instanceof a ? n : new a(n), r = new l(i);
                    return e.some(function (t) {
                        return r.handle(t), i.interrupted
                    }), i
                }
                return null
            }, i.prototype.relayAsync = function (t, n, e) {
                function i (t) {
                    !s.length || t || r.interrupted ? e(t) : o.handle(s.shift(), i)
                }

                var r = n instanceof a ? n : new a(n), o = new l(r, e), s = [];
                return p(this, function (n) {
                    var e = n._intentFilters[t];
                    Array.isArray(e) && e.length && (s = s.concat(e))
                }), i(), r
            }, i.prototype.relayAsyncGlobal = function (t, n, e) {
                return i.prototype.relayAsync.apply(r(this), arguments)
            }
        }, {"./Channel": 2, "./Intent": 4, "./Operation": 5, "./Radio": 6, "./Transmission": 7}],
        4: [function (t, n, e) {
            function i (t) {
                this.data = t, this.rejected = !1, this.interrupted = !1, this.state = {}
            }

            var r = t("./Radio");
            n.exports = i, i.prototype = Object.create(r.prototype), i.prototype.reject = function (t, n) {
                this.rejected = !0, this.state(t, n)
            }, i.prototype.interrupt = function (t, n) {
                this.interrupted || (this.interrupted = !0, "undefined" != typeof n && this.reject(t, n))
            }, i.prototype.state = function (t, n) {
                if ("string" == typeof t && "undefined" != typeof n)this.state[t] = n;
                else for (var e in t)t.hasOwnProperty(e) && (this.state[e] = t[e])
            }
        }, {"./Radio": 6}],
        5: [function (t, n, e) {
            function i (t, n, e) {
                this.handler = t, this.onEnd = n, this.oneTime = !!e
            }

            n.exports = i
        }, {}],
        6: [function (t, n, e) {
            function i () {
                this._channels = []
            }

            var r = t("./Channel");
            n.exports = i, i.prototype.channel = function (t) {
                return this._channels[t] || (this._channels[t] = new r(t))
            }, i.prototype.channelExists = function (t) {
                return !!t && ("string" == typeof t ? this._channels.hasOwnProperty(t) : this._channels.hasOwnProperty(t.name))
            }, i.prototype.deleteChannel = function (t) {
                return t instanceof r ? delete this._channels[t.name] : delete this._channels[t]
            }, i.prototype.hasSubscribers = function (t) {
                return this.channelExists(t) && this.channel(t).hasSubscribers()
            }, i.prototype.isSubscribed = function (t, n) {
                return this.channelExists(t) && this.channel(t).isSubscribed(n)
            }, i.prototype.publish = i.prototype.broadcast = function (t) {
                if (this.channelExists(t)) {
                    t = this.channel(t);
                    var n = [].slice.call(arguments, 1);
                    return t.broadcast.apply(t, n)
                }
                return !1
            }, i.prototype.subscribe = function (t, n) {
                return this.channel(t).subscribe(n), this
            }, i.prototype.unsubscribe = function (t, n) {
                return this.channelExists(t) && this.channel(t).unsubscribe(n), this
            }, i.prototype.peek = function (t, n) {
                return this.channel(t).peek(n), this
            }, i.prototype.emptyChannel = function (t) {
                return this.channelExists(t) && this.channel(t).empty(), this
            }
        }, {"./Channel": 2}],
        7: [function (t, n, e) {
            function i (t, n) {
                this._onEndCallbacks = [], this._intent = t, this._finalCallback = n, this.finished = !1
            }

            function r (t) {
                t._onEndCallbacks = null, t._intent = null, t._finalCallback = null, t.finished = !0
            }

            function o (t) {
                if (!t.finished) {
                    if (t.finished = !0, t._onEndCallbacks && t._onEndCallbacks.length) {
                        var n = t._intent;
                        t._onEndCallbacks.forEach(function (t) {
                            t(n)
                        })
                    }
                    "function" == typeof t._finalCallback && t._finalCallback(t._intent)
                }
            }

            n.exports = i, i.prototype.handle = function (t, n) {
                var e = this;
                if (!e.finished) {
                    var i = e._intent;
                    i.interrupted || (t.handler.call(null, i, n), i.interrupted ? r(e) : t.onEnd && e._onEndCallbacks.push(t.onEnd))
                }
            }, i.prototype.attemptFinish = function () {
                o(this)
            }
        }, {}]
    }, {}, [1])(1)
});
